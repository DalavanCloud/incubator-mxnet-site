<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="LSTM time series example" property="og:title">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image">
<meta content="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/og-logo.png" property="og:image:secure_url">
<meta content="LSTM time series example" property="og:description"/>
<title>LSTM time series example — mxnet  documentation</title>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="../../_static/basic.css" rel="stylesheet" type="text/css">
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../_static/mxnet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/searchtools_custom.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<script src="../../_static/selectlang.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript"> jQuery(function() { Search.loadIndex("/searchindex.js"); Search.init();}); </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
      Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96378503-1', 'auto');
      ga('send', 'pageview');

    </script>
<!-- -->
<!-- <script type="text/javascript" src="../../_static/jquery.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/underscore.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="../../_static/doctools.js"></script> -->
<!-- -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<!-- -->
<link href="../../genindex.html" rel="index" title="Index">
<link href="../../search.html" rel="search" title="Search"/>
<link href="index.html" rel="up" title="R Tutorials"/>
<link href="charRnnModel.html" rel="next" title="Character-level Language Model using RNN"/>
<link href="CustomLossFunction.html" rel="prev" title="Customized loss function"/>
<link href="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-icon.png" rel="icon" type="image/png"/>
</link></link></link></meta></meta></meta></head>
<body background="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet-background-compressed.jpeg" role="document">
<div class="content-block"><div class="navbar navbar-fixed-top">
<div class="container" id="navContainer">
<div class="innder" id="header-inner">
<h1 id="logo-wrap">
<a href="../../" id="logo"><img src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/mxnet_logo.png"/></a>
</h1>
<nav class="nav-bar" id="main-nav">
<a class="main-nav-link" href="../../install/index.html">Install</a>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Gluon <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">The Straight Dope (Tutorials)</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">API <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-docs">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Docs <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-docs">
<li><a class="main-nav-link" href="../../faq/index.html">FAQ</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet/tree/master/example">Examples</a></li>
<li><a class="main-nav-link" href="../../architecture/index.html">Architecture</a></li>
<li><a class="main-nav-link" href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home">Developer Wiki</a></li>
<li><a class="main-nav-link" href="../../api/python/gluon/model_zoo.html">Model Zoo</a></li>
<li><a class="main-nav-link" href="../../api/python/contrib/onnx.html">ONNX</a></li>
</li></ul>
</span>
<span id="dropdown-menu-position-anchor-community">
<a aria-expanded="true" aria-haspopup="true" class="main-nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">Community <span class="caret"></span></a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu-community">
<li><a class="main-nav-link" href="http://discuss.mxnet.io">Forum</a></li>
<li><a class="main-nav-link" href="https://github.com/apache/incubator-mxnet">Github</a></li>
<li><a class="main-nav-link" href="../../community/contribute.html">Contribute</a></li>
<li><a class="main-nav-link" href="../../community/ecosystem.html">Ecosystem</a></li>
<li><a class="main-nav-link" href="../../community/powered_by.html">Powered By</a></li>
</ul>
</span>
<span id="dropdown-menu-position-anchor-version" style="position: relative"><a href="#" class="main-nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">Versions(master)<span class="caret"></span></a><ul id="package-dropdown-menu" class="dropdown-menu"><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.3.0/index.html>1.3.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a class="main-nav-link" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li></ul></span></nav>
<script> function getRootPath(){ return "../../" } </script>
<div class="burgerIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">☰</a>
<ul class="dropdown-menu" id="burgerMenu">
<li><a href="../../install/index.html">Install</a></li>
<li><a class="main-nav-link" href="../../tutorials/index.html">Tutorials</a></li>
<li class="dropdown-submenu dropdown">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Gluon</a>
<ul class="dropdown-menu navbar-menu" id="package-dropdown-menu">
<li><a class="main-nav-link" href="../../gluon/index.html">About</a></li>
<li><a class="main-nav-link" href="http://gluon.mxnet.io">The Straight Dope (Tutorials)</a></li>
<li><a class="main-nav-link" href="https://gluon-cv.mxnet.io">GluonCV Toolkit</a></li>
<li><a class="main-nav-link" href="https://gluon-nlp.mxnet.io/">GluonNLP Toolkit</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">API</a>
<ul class="dropdown-menu">
<li><a class="main-nav-link" href="../../api/python/index.html">Python</a></li>
<li><a class="main-nav-link" href="../../api/c++/index.html">C++</a></li>
<li><a class="main-nav-link" href="../../api/clojure/index.html">Clojure</a></li>
<li><a class="main-nav-link" href="../../api/julia/index.html">Julia</a></li>
<li><a class="main-nav-link" href="../../api/perl/index.html">Perl</a></li>
<li><a class="main-nav-link" href="../../api/r/index.html">R</a></li>
<li><a class="main-nav-link" href="../../api/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="dropdown-submenu">
<a aria-expanded="true" aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" tabindex="-1">Docs</a>
<ul class="dropdown-menu">
<li><a href="../../faq/index.html" tabindex="-1">FAQ</a></li>
<li><a href="../../tutorials/index.html" tabindex="-1">Tutorials</a></li>
<li><a href="https://github.com/apache/incubator-mxnet/tree/master/example" tabindex="-1">Examples</a></li>
<li><a href="../../architecture/index.html" tabindex="-1">Architecture</a></li>
<li><a href="https://cwiki.apache.org/confluence/display/MXNET/Apache+MXNet+Home" tabindex="-1">Developer Wiki</a></li>
<li><a href="../../api/python/gluon/model_zoo.html" tabindex="-1">Gluon Model Zoo</a></li>
<li><a href="../../api/python/contrib/onnx.html" tabindex="-1">ONNX</a></li>
</ul>
</li>
<li class="dropdown-submenu dropdown">
<a aria-haspopup="true" class="dropdown-toggle burger-link" data-toggle="dropdown" href="#" role="button" tabindex="-1">Community</a>
<ul class="dropdown-menu">
<li><a href="http://discuss.mxnet.io" tabindex="-1">Forum</a></li>
<li><a href="https://github.com/apache/incubator-mxnet" tabindex="-1">Github</a></li>
<li><a href="../../community/contribute.html" tabindex="-1">Contribute</a></li>
<li><a href="../../community/ecosystem.html" tabindex="-1">Ecosystem</a></li>
<li><a href="../../community/powered_by.html" tabindex="-1">Powered By</a></li>
</ul>
</li>
<li id="dropdown-menu-position-anchor-version-mobile" class="dropdown-submenu" style="position: relative"><a href="#" tabindex="-1">Versions(master)</a><ul class="dropdown-menu"><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/master/index.html>master</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.3.0/index.html>1.3.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.2.1/index.html>1.2.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.1.0/index.html>1.1.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/1.0.0/index.html>1.0.0</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.12.1/index.html>0.12.1</a></li><li><a tabindex="-1" href=http://mxnet.incubator.apache.org/versions/0.11.0/index.html>0.11.0</a></li></ul></li></ul>
</div>
<div class="plusIcon dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span aria-hidden="true" class="glyphicon glyphicon-plus"></span></a>
<ul class="dropdown-menu dropdown-menu-right" id="plusMenu"></ul>
</div>
<div id="search-input-wrap">
<form action="../../search.html" autocomplete="off" class="" method="get" role="search">
<div class="form-group inner-addon left-addon">
<i class="glyphicon glyphicon-search"></i>
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default"/>
</input></form>
<div id="search-preview"></div>
</div>
<div id="searchIcon">
<span aria-hidden="true" class="glyphicon glyphicon-search"></span>
</div>
<!-- <div id="lang-select-wrap"> -->
<!--   <label id="lang-select-label"> -->
<!--     <\!-- <i class="fa fa-globe"></i> -\-> -->
<!--     <span></span> -->
<!--   </label> -->
<!--   <select id="lang-select"> -->
<!--     <option value="en">Eng</option> -->
<!--     <option value="zh">中文</option> -->
<!--   </select> -->
<!-- </div> -->
<!--     <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a> -->
</div>
</div>
</div>
<script type="text/javascript">
        $('body').css('background', 'white');
    </script>
<div class="container">
<div class="row">
<div aria-label="main navigation" class="sphinxsidebar leftsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">MXNet APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/index.html">MXNet Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">MXNet Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">MXNet FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gluon/index.html">About Gluon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installing MXNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#nvidia-jetson-tx-family">Nvidia Jetson TX family</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html#source-download">Source Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_zoo/index.html">MXNet Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Tutorials</a></li>
</ul>
</div>
</div>
<div class="content">
<div class="page-tracker"></div>
<div class="section" id="lstm-time-series-example">
<span id="lstm-time-series-example"></span><h1>LSTM time series example<a class="headerlink" href="#lstm-time-series-example" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to use an LSTM model with multivariate data, and generate predictions from it. For demonstration purposes, we used an open source <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data">pollution data</a>.
The tutorial is an illustration of how to use LSTM models with MXNet-R. We are forecasting the air pollution with data recorded at the US embassy in Beijing, China for five years.</p>
<p>Dataset Attribution:
“PM2.5 data of US Embassy in Beijing”
We want to predict pollution levels(PM2.5 concentration) in the city given the above dataset.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span>Dataset description<span class="o">:</span>
No<span class="o">:</span> row number
year<span class="o">:</span> year of data <span class="kr">in</span> this <span class="kp">row</span>
month<span class="o">:</span> month of data <span class="kr">in</span> this <span class="kp">row</span>
day<span class="o">:</span> day of data <span class="kr">in</span> this <span class="kp">row</span>
hour<span class="o">:</span> hour of data <span class="kr">in</span> this <span class="kp">row</span>
pm2.5<span class="o">:</span> PM2.5 concentration
DEWP<span class="o">:</span> Dew Point
TEMP<span class="o">:</span> Temperature
PRES<span class="o">:</span> Pressure
cbwd<span class="o">:</span> Combined wind direction
Iws<span class="o">:</span> Cumulated wind speed
Is<span class="o">:</span> Cumulated hours of snow
Ir<span class="o">:</span> Cumulated hours of rain
</pre></div>
</div>
<p>We use past PM2.5 concentration, dew point, temperature, pressure, wind speed, snow and rain to predict
PM2.5 concentration levels.</p>
<div class="section" id="load-and-pre-process-the-data">
<span id="load-and-pre-process-the-data"></span><h2>Load and pre-process the data<a class="headerlink" href="#load-and-pre-process-the-data" title="Permalink to this headline">¶</a></h2>
<p>The first step is to load in the data and preprocess it. It is assumed that the data has been downloaded in a .csv file: data.csv from the <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data">pollution dataset</a></p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="c1">## Loading required packages</span>
<span class="kn">library</span><span class="p">(</span><span class="s">"readr"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">"dplyr"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">"mxnet"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">"abind"</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="c1">## Preprocessing steps</span>
Data <span class="o"><-</span> read.csv<span class="p">(</span>file <span class="o">=</span> <span class="s">"/Users/khedia/Downloads/data.csv"</span><span class="p">,</span>
                 header <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                 sep <span class="o">=</span> <span class="s">","</span><span class="p">)</span>

<span class="c1">## Extracting specific features from the dataset as variables for time series We extract</span>
<span class="c1">## pollution, temperature, pressue, windspeed, snowfall and rainfall information from dataset</span>
df <span class="o"><-</span> <span class="kt">data.frame</span><span class="p">(</span>Data<span class="o">$</span>pm2.5<span class="p">,</span>
                 Data<span class="o">$</span>DEWP<span class="p">,</span>
                 Data<span class="o">$</span>TEMP<span class="p">,</span>
                 Data<span class="o">$</span>PRES<span class="p">,</span>
                 Data<span class="o">$</span>Iws<span class="p">,</span>
                 Data<span class="o">$</span>Is<span class="p">,</span>
                 Data<span class="o">$</span>Ir<span class="p">)</span>
df<span class="p">[</span><span class="kp">is.na</span><span class="p">(</span>df<span class="p">)]</span> <span class="o"><-</span> <span class="m">0</span>

<span class="c1">## Now we normalise each of the feature set to a range(0,1)</span>
df <span class="o"><-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kp">as.matrix</span><span class="p">(</span>df<span class="p">),</span>
             ncol <span class="o">=</span> <span class="kp">ncol</span><span class="p">(</span>df<span class="p">),</span>
             dimnames <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>

rangenorm <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span>
    <span class="p">(</span>x <span class="o">-</span> <span class="kp">min</span><span class="p">(</span>x<span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="kp">max</span><span class="p">(</span>x<span class="p">)</span> <span class="o">-</span> <span class="kp">min</span><span class="p">(</span>x<span class="p">))</span>
<span class="p">}</span>
df <span class="o"><-</span> <span class="kp">apply</span><span class="p">(</span>df<span class="p">,</span> <span class="m">2</span><span class="p">,</span> rangenorm<span class="p">)</span>
df <span class="o"><-</span> <span class="kp">t</span><span class="p">(</span>df<span class="p">)</span>
</pre></div>
</div>
<p>For using multidimesional data with MXNet-R, we need to convert training data to the form
(n_dim x seq_len x num_samples). For one-to-one RNN flavours labels should be of the form (seq_len x num_samples) while for many-to-one flavour, the labels should be of the form (1 x num_samples). Please note that MXNet-R currently supports only these two flavours of RNN.
We have used n_dim = 7, seq_len = 100,  and num_samples = 430 because the dataset has 430 samples, each the length of 100 timestamps, we have seven time series as input features so each input has dimesnion of seven at each time step.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span>n_dim <span class="o"><-</span> <span class="m">7</span>
seq_len <span class="o"><-</span> <span class="m">100</span>
num_samples <span class="o"><-</span> <span class="m">430</span>

<span class="c1">## extract only required data from dataset</span>
trX <span class="o"><-</span> df<span class="p">[</span><span class="m">1</span><span class="o">:</span>n_dim<span class="p">,</span> <span class="m">25</span><span class="o">:</span><span class="p">(</span><span class="m">24</span> <span class="o">+</span> <span class="p">(</span>seq_len <span class="o">*</span> num_samples<span class="p">))]</span>

<span class="c1">## the label data(next PM2.5 concentration) should be one time step</span>
<span class="c1">## ahead of the current PM2.5 concentration</span>
trY <span class="o"><-</span> df<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">26</span><span class="o">:</span><span class="p">(</span><span class="m">25</span> <span class="o">+</span> <span class="p">(</span>seq_len <span class="o">*</span> num_samples<span class="p">))]</span>

<span class="c1">## reshape the matrices in the format acceptable by MXNetR RNNs</span>
trainX <span class="o"><-</span> trX
<span class="kp">dim</span><span class="p">(</span>trainX<span class="p">)</span> <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span>n_dim<span class="p">,</span> <span class="kp">seq_len</span><span class="p">,</span> num_samples<span class="p">)</span>
trainY <span class="o"><-</span> trY
<span class="kp">dim</span><span class="p">(</span>trainY<span class="p">)</span> <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="kp">seq_len</span><span class="p">,</span> num_samples<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-and-training-the-network">
<span id="defining-and-training-the-network"></span><h2>Defining and training the network<a class="headerlink" href="#defining-and-training-the-network" title="Permalink to this headline">¶</a></h2>
<div class="highlight-r"><div class="highlight"><pre><span></span>batch.size <span class="o"><-</span> <span class="m">32</span>

<span class="c1"># take first 300 samples for training - remaining 100 for evaluation</span>
train_ids <span class="o"><-</span> <span class="m">1</span><span class="o">:</span><span class="m">300</span>
eval_ids <span class="o"><-</span> <span class="m">301</span><span class="o">:</span><span class="m">400</span>

<span class="c1">## The number of samples used for training and evaluation is arbitrary.  I have kept aside few</span>
<span class="c1">## samples for testing purposes create dataiterators</span>
train.data <span class="o"><-</span> mx.io.arrayiter<span class="p">(</span>data <span class="o">=</span> trainX<span class="p">[,</span> <span class="p">,</span> train_ids<span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">],</span> 
                              label <span class="o">=</span> trainY<span class="p">[,</span> train_ids<span class="p">],</span>
                              batch.size <span class="o">=</span> batch.size<span class="p">,</span> shuffle <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

eval.data <span class="o"><-</span> mx.io.arrayiter<span class="p">(</span>data <span class="o">=</span> trainX<span class="p">[,</span> <span class="p">,</span> eval_ids<span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">],</span> 
                             label <span class="o">=</span> trainY<span class="p">[,</span> eval_ids<span class="p">],</span>
                             batch.size <span class="o">=</span> batch.size<span class="p">,</span> shuffle <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">## Create the symbol for RNN</span>
symbol <span class="o"><-</span> rnn.graph<span class="p">(</span>num_rnn_layer <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                    num_hidden <span class="o">=</span> <span class="m">5</span><span class="p">,</span>
                    input_size <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                    num_embed <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                    num_decode <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                    masking <span class="o">=</span> <span class="bp">F</span><span class="p">,</span> 
                    loss_output <span class="o">=</span> <span class="s">"linear"</span><span class="p">,</span>
                    dropout <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> 
                    ignore_label <span class="o">=</span> <span class="m">-1</span><span class="p">,</span> 
                    cell_type <span class="o">=</span> <span class="s">"lstm"</span><span class="p">,</span> 
                    output_last_state <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
                    config <span class="o">=</span> <span class="s">"one-to-one"</span><span class="p">)</span>



mx.metric.mse.seq <span class="o"><-</span> mx.metric.custom<span class="p">(</span><span class="s">"MSE"</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span>label<span class="p">,</span> pred<span class="p">)</span> <span class="p">{</span>
    label <span class="o">=</span> mx.nd.reshape<span class="p">(</span>label<span class="p">,</span> shape <span class="o">=</span> <span class="m">-1</span><span class="p">)</span>
    pred <span class="o">=</span> mx.nd.reshape<span class="p">(</span>pred<span class="p">,</span> shape <span class="o">=</span> <span class="m">-1</span><span class="p">)</span>
    res <span class="o"><-</span> mx.nd.mean<span class="p">(</span>mx.nd.square<span class="p">(</span>label <span class="o">-</span> pred<span class="p">))</span>
    <span class="kr">return</span><span class="p">(</span><span class="kp">as.array</span><span class="p">(</span>res<span class="p">))</span>
<span class="p">})</span>



ctx <span class="o"><-</span> mx.cpu<span class="p">()</span>

initializer <span class="o"><-</span> mx.init.Xavier<span class="p">(</span>rnd_type <span class="o">=</span> <span class="s">"gaussian"</span><span class="p">,</span>
                              factor_type <span class="o">=</span> <span class="s">"avg"</span><span class="p">,</span> 
                              magnitude <span class="o">=</span> <span class="m">3</span><span class="p">)</span>

optimizer <span class="o"><-</span> mx.opt.create<span class="p">(</span><span class="s">"adadelta"</span><span class="p">,</span>
                           rho <span class="o">=</span> <span class="m">0.9</span><span class="p">,</span> 
                           eps <span class="o">=</span> <span class="m">1e-05</span><span class="p">,</span> 
                           wd <span class="o">=</span> <span class="m">1e-06</span><span class="p">,</span> 
                           clip_gradient <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                           rescale.grad <span class="o">=</span> <span class="m">1</span><span class="o">/</span>batch.size<span class="p">)</span>

logger <span class="o"><-</span> mx.metric.logger<span class="p">()</span>
epoch.end.callback <span class="o"><-</span> mx.callback.log.train.metric<span class="p">(</span>period <span class="o">=</span> <span class="m">10</span><span class="p">,</span> 
                                                   logger <span class="o">=</span> logger<span class="p">)</span>

<span class="c1">## train the network</span>
<span class="kp">system.time</span><span class="p">(</span>model <span class="o"><-</span> mx.model.buckets<span class="p">(</span>symbol <span class="o">=</span> symbol<span class="p">,</span> 
                                      train.data <span class="o">=</span> train.data<span class="p">,</span> 
                                      eval.data <span class="o">=</span> eval.data<span class="p">,</span>
                                      num.round <span class="o">=</span> <span class="m">100</span><span class="p">,</span> 
                                      ctx <span class="o">=</span> ctx<span class="p">,</span> 
                                      verbose <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
                                      metric <span class="o">=</span> mx.metric.mse.seq<span class="p">,</span> 
                                      initializer <span class="o">=</span> initializer<span class="p">,</span>
                                      optimizer <span class="o">=</span> optimizer<span class="p">,</span> 
                                      batch.end.callback <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> 
                                      epoch.end.callback <span class="o">=</span> epoch.end.callback<span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Start</span> <span class="n">training</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">devices</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.197570244409144</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0153861071448773</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0152517843060195</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0128299412317574</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0124418652616441</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.010827143676579</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0105128229130059</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00940261723008007</span>
<span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00914482437074184</span>
<span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00830172537826002</span>
<span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00813581114634871</span>
<span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00747016374953091</span>
<span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00735094994306564</span>
<span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00679832429159433</span>
<span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00672049634158611</span>
<span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00623159145470709</span>
<span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00620287149213254</span>
<span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00577476259786636</span>
<span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00577280316501856</span>
<span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00539038667920977</span>
<span class="o">..........</span>
<span class="o">..........</span>
<span class="p">[</span><span class="mi">91</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177705133100972</span>
<span class="p">[</span><span class="mi">91</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154715491225943</span>
<span class="p">[</span><span class="mi">92</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177639147732407</span>
<span class="p">[</span><span class="mi">92</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154592350008897</span>
<span class="p">[</span><span class="mi">93</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177577760769054</span>
<span class="p">[</span><span class="mi">93</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154474508599378</span>
<span class="p">[</span><span class="mi">94</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0017752077546902</span>
<span class="p">[</span><span class="mi">94</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0015436161775142</span>
<span class="p">[</span><span class="mi">95</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177468206966296</span>
<span class="p">[</span><span class="mi">95</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154253660002723</span>
<span class="p">[</span><span class="mi">96</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177419915562496</span>
<span class="p">[</span><span class="mi">96</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154150440357625</span>
<span class="p">[</span><span class="mi">97</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.0017737578949891</span>
<span class="p">[</span><span class="mi">97</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00154051734716631</span>
<span class="p">[</span><span class="mi">98</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177335749613121</span>
<span class="p">[</span><span class="mi">98</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00153957353904843</span>
<span class="p">[</span><span class="mi">99</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177299699280411</span>
<span class="p">[</span><span class="mi">99</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00153867155313492</span>
<span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="n">Train</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00177267640829086</span>
<span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="n">Validation</span><span class="o">-</span><span class="n">MSE</span><span class="o">=</span><span class="mf">0.00153781197150238</span>

   <span class="n">user</span>  <span class="n">system</span> <span class="n">elapsed</span> 
 <span class="mf">21.937</span>   <span class="mf">1.914</span>  <span class="mf">13.402</span> 
</pre></div>
</div>
<p>We can see how mean squared error varies with epochs below.</p>
<p><img alt="png" src="https://github.com/dmlc/web-data/blob/master/mxnet/doc/tutorials/r/images/loss.png?raw=true"><!--notebook-skip-line--></img></p>
</div>
<div class="section" id="inference-on-the-network">
<span id="inference-on-the-network"></span><h2>Inference on the network<a class="headerlink" href="#inference-on-the-network" title="Permalink to this headline">¶</a></h2>
<p>Now we have trained the network. Let’s use it for inference.</p>
<div class="highlight-r"><div class="highlight"><pre><span></span><span class="c1">## We extract the state symbols for RNN</span>
internals <span class="o"><-</span> model<span class="o">$</span>symbol<span class="o">$</span>get.internals<span class="p">()</span>
sym_state <span class="o"><-</span> internals<span class="o">$</span>get.output<span class="p">(</span><span class="kp">which</span><span class="p">(</span>internals<span class="o">$</span>outputs <span class="o">%in%</span> <span class="s">"RNN_state"</span><span class="p">))</span>
sym_state_cell <span class="o"><-</span> internals<span class="o">$</span>get.output<span class="p">(</span><span class="kp">which</span><span class="p">(</span>internals<span class="o">$</span>outputs <span class="o">%in%</span> <span class="s">"RNN_state_cell"</span><span class="p">))</span>
sym_output <span class="o"><-</span> internals<span class="o">$</span>get.output<span class="p">(</span><span class="kp">which</span><span class="p">(</span>internals<span class="o">$</span>outputs <span class="o">%in%</span> <span class="s">"loss_output"</span><span class="p">))</span>
symbol <span class="o"><-</span> mx.symbol.Group<span class="p">(</span>sym_output<span class="p">,</span> sym_state<span class="p">,</span> sym_state_cell<span class="p">)</span>

<span class="c1">## We will predict 100 timestamps for 401st sample (first sample from the test samples)</span>
pred_length <span class="o"><-</span> <span class="m">100</span>
predicted <span class="o"><-</span> <span class="kt">numeric</span><span class="p">()</span>

<span class="c1">## We pass the 400th sample through the network to get the weights and use it for predicting next</span>
<span class="c1">## 100 time stamps.</span>
data <span class="o"><-</span> mx.nd.array<span class="p">(</span>trainX<span class="p">[,</span> <span class="p">,</span> <span class="m">400</span><span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">])</span>
label <span class="o"><-</span> mx.nd.array<span class="p">(</span>trainY<span class="p">[,</span> <span class="m">400</span><span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">])</span>


<span class="c1">## We create dataiterators for the input, please note that the label is required to create</span>
<span class="c1">## iterator and will not be used in the inference. You can use dummy values too in the label.</span>
infer.data <span class="o"><-</span> mx.io.arrayiter<span class="p">(</span>data <span class="o">=</span> data<span class="p">,</span> 
                              label <span class="o">=</span> label<span class="p">,</span> 
                              batch.size <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                              shuffle <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

infer <span class="o"><-</span> mx.infer.rnn.one<span class="p">(</span>infer.data <span class="o">=</span> infer.data<span class="p">,</span> 
                          symbol <span class="o">=</span> symbol<span class="p">,</span> 
                          arg.params <span class="o">=</span> model<span class="o">$</span>arg.params<span class="p">,</span>
                          aux.params <span class="o">=</span> model<span class="o">$</span>aux.params<span class="p">,</span> 
                          input.params <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> 
                          ctx <span class="o">=</span> ctx<span class="p">)</span>
<span class="c1">## Once we get the weights for the above time series, we try to predict the next 100 steps for</span>
<span class="c1">## this time series, which is technically our 401st time series.</span>

actual <span class="o"><-</span> trainY<span class="p">[,</span> <span class="m">401</span><span class="p">]</span>

<span class="c1">## Now we iterate one by one to generate each of the next timestamp pollution values</span>

<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>pred_length<span class="p">)</span> <span class="p">{</span>

    data <span class="o"><-</span> mx.nd.array<span class="p">(</span>trainX<span class="p">[,</span> i<span class="p">,</span> <span class="m">401</span><span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">])</span>
    label <span class="o"><-</span> mx.nd.array<span class="p">(</span>trainY<span class="p">[</span>i<span class="p">,</span> <span class="m">401</span><span class="p">,</span> drop <span class="o">=</span> <span class="bp">F</span><span class="p">])</span>
    infer.data <span class="o"><-</span> mx.io.arrayiter<span class="p">(</span>data <span class="o">=</span> data<span class="p">,</span> 
                                  label <span class="o">=</span> label<span class="p">,</span> 
                                  batch.size <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                                  shuffle <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
    <span class="c1">## note that we use rnn state values from previous iterations here</span>
    infer <span class="o"><-</span> mx.infer.rnn.one<span class="p">(</span>infer.data <span class="o">=</span> infer.data<span class="p">,</span>
                              symbol <span class="o">=</span> symbol<span class="p">,</span>
                              ctx <span class="o">=</span> ctx<span class="p">,</span> 
                              arg.params <span class="o">=</span> model<span class="o">$</span>arg.params<span class="p">,</span>
                              aux.params <span class="o">=</span> model<span class="o">$</span>aux.params<span class="p">,</span> 
                              input.params <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>rnn.state <span class="o">=</span> infer<span class="p">[[</span><span class="m">2</span><span class="p">]],</span> 
                                                  rnn.state.cell <span class="o">=</span> infer<span class="p">[[</span><span class="m">3</span><span class="p">]]))</span>

    pred <span class="o"><-</span> infer<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
    predicted <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span>predicted<span class="p">,</span> <span class="kp">as.numeric</span><span class="p">(</span><span class="kp">as.array</span><span class="p">(</span>pred<span class="p">)))</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Now predicted contains the predicted 100 values. We use ggplot to plot the actual and predicted values as shown below.</p>
<p><img alt="png" src="https://github.com/dmlc/web-data/blob/master/mxnet/doc/tutorials/r/images/sample_401.png?raw=true"/><!--notebook-skip-line--></p>
<p>We also repeated the above experiments to generate the next 100 samples to 301st time series and we got the following results.</p>
<p><img alt="png" src="https://github.com/dmlc/web-data/blob/master/mxnet/doc/tutorials/r/images/sample_301.png?raw=true"/><!--notebook-skip-line--></p>
<p>The above tutorial is just for demonstration purposes and has not been tuned extensively for accuracy.</p>
<p>For more tutorials on MXNet-R, head on to <a class="reference external" href="https://mxnet.incubator.apache.org/tutorials/r/index.html">MXNet-R tutorials</a></p>
</div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar rightsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">LSTM time series example</a><ul>
<li><a class="reference internal" href="#load-and-pre-process-the-data">Load and pre-process the data</a></li>
<li><a class="reference internal" href="#defining-and-training-the-network">Defining and training the network</a></li>
<li><a class="reference internal" href="#inference-on-the-network">Inference on the network</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div><div class="footer">
<div class="section-disclaimer">
<div class="container">
<div>
<img height="60" src="https://raw.githubusercontent.com/dmlc/web-data/master/mxnet/image/apache_incubator_logo.png"/>
<p>
            Apache MXNet is an effort undergoing incubation at The Apache Software Foundation (ASF), <strong>sponsored by the <i>Apache Incubator</i></strong>. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
        </p>
<p>
            "Copyright © 2017-2018, The Apache Software Foundation
            Apache MXNet, MXNet, Apache, the Apache feather, and the Apache MXNet project logo are either registered trademarks or trademarks of the Apache Software Foundation."
        </p>
</div>
</div>
</div>
</div> <!-- pagename != index -->
</div>
<script crossorigin="anonymous" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="../../_static/js/sidebar.js" type="text/javascript"></script>
<script src="../../_static/js/search.js" type="text/javascript"></script>
<script src="../../_static/js/navbar.js" type="text/javascript"></script>
<script src="../../_static/js/clipboard.min.js" type="text/javascript"></script>
<script src="../../_static/js/copycode.js" type="text/javascript"></script>
<script src="../../_static/js/page.js" type="text/javascript"></script>
<script src="../../_static/js/docversion.js" type="text/javascript"></script>
<script type="text/javascript">
        $('body').ready(function () {
            $('body').css('visibility', 'visible');
        });
    </script>
</body>
</html>